# 李萨如图形演示装置 - 系统设计需求分析

## 1. 需求分析

### 1.1 输入信号要求
- **X轴信号**: 正弦波，峰峰值2V，频率范围1kHz~1.5kHz
- **Y轴信号**: 基于X轴信号处理生成

### 1.2 Y轴信号要求
- **频率倍数**: 1~5倍可调，1倍步进（即1x, 2x, 3x, 4x, 5x）
- **频率精度**: 误差绝对值 ≤ 100Hz
- **幅度范围**: 1V, 2V, 3V 程控可选
- **幅度精度**: 误差绝对值 ≤ 0.1V
- **波形类型**: 正弦波 + 三角波可转换

### 1.3 相位测量要求
- **测量范围**: Y轴与X轴信号的初始相位差
- **测量精度**: 误差绝对值 ≤ 5°

### 1.4 显示要求
- **显示器**: 128×64 LCD (JLX12864G-086-PC)
- **显示内容**: 李萨如图形实时显示

### 1.5 限用器件
- 电阻、电容
- 三极管: 2N2222
- 锁相环: CD4046
- 多路开关: CD4052
- 数字电位器: MCP4018T
- 运放: LM324
- 数字芯片: 74HC00, 74HC161
- 按键、LCD屏
- 单片机: MSP430G2553

## 2. 系统架构设计

### 2.1 总体架构
```
输入信号(X) → 信号调理 → ADC采样 ← MSP430G2553 → 控制逻辑
                                       ↓
显示LCD ← 图形处理 ← 相位测量 ← Y轴信号生成(DDS+PGA+波形变换)
```

### 2.2 功能模块划分

#### 2.2.1 信号输入与调理模块
- **X轴信号调理**: 将输入信号调整到MSP430 ADC可接受范围(0-3.3V)
- **信号缓冲**: 使用LM324进行信号隔离和驱动

#### 2.2.2 频率测量模块
- **频率检测**: 利用MSP430的Timer_A进行频率测量
- **精度要求**: 确保测量误差<100Hz

#### 2.2.3 Y轴信号生成模块
- **PLL频率合成**: CD4046实现倍频功能(1x-5x)
- **幅度控制**: MCP4018T数字电位器+LM324可编程增益放大器
- **波形变换**: 正弦波→三角波转换电路

#### 2.2.4 相位测量模块
- **相位检测**: 利用过零检测和时间差测量
- **精度算法**: 软件滤波确保±5°精度

#### 2.2.5 显示模块
- **LCD驱动**: 128×64点阵显示
- **图形算法**: 李萨如图形实时绘制
- **用户界面**: 参数显示和控制

#### 2.2.6 控制模块
- **按键输入**: 参数设置和功能切换
- **参数存储**: 当前设置保持
- **系统控制**: 协调各模块工作

## 3. 技术指标分解

### 3.1 频率合成精度分析
- 输入频率: 1-1.5kHz
- 输出频率: 1-7.5kHz (5倍时)
- PLL精度: 利用CD4046的VCO特性，配合外围RC网络
- 误差控制: 软件校准+硬件补偿

### 3.2 幅度控制精度分析
- MCP4018T分辨率: 7位(128步)
- 控制范围: 1-3V
- 每步精度: ≈0.016V
- 满足±0.1V要求

### 3.3 相位测量精度分析
- 采样频率: 建议≥10kHz (MSP430 ADC)
- 时间分辨率: 100μs
- 相位分辨率: 360°×100μs×1.5kHz ≈ 0.054° (理论值)
- 实际精度: 考虑噪声和量化误差，±5°可达到

## 4. 系统实现策略

### 4.1 硬件实现要点
1. **信号完整性**: 注意高频信号的布线和去耦
2. **电源管理**: 模拟和数字电源分离
3. **EMC设计**: 合理的地平面和屏蔽

### 4.2 软件实现要点
1. **实时性**: 确保图形刷新率≥10Hz
2. **精度算法**: 数字滤波和校准算法
3. **用户体验**: 直观的操作界面

### 4.3 测试验证策略
1. **功能测试**: 各模块独立测试
2. **精度测试**: 使用标准信号源验证
3. **稳定性测试**: 长时间运行测试

## 5. 项目计划

### 阶段1: 硬件设计 (2-3天)
- 原理图设计
- Proteus仿真验证
- PCB设计

### 阶段2: 软件开发 (3-4天)
- 底层驱动开发
- 算法实现
- 用户界面

### 阶段3: 集成测试 (1-2天)
- 系统联调
- 性能优化
- 文档整理

## 6. 预期技术难点

1. **PLL锁定时间**: CD4046的锁定时间可能影响响应速度
2. **相位测量精度**: 需要优化算法以达到±5°要求
3. **LCD刷新率**: 128×64显示的计算量较大
4. **EMC问题**: 数字电路对模拟信号的干扰

## 7. 解决方案预案

1. **快速锁定**: 优化PLL环路滤波器参数
2. **相位算法**: 采用多点采样+数字滤波
3. **显示优化**: 局部刷新+缓存策略
4. **EMC优化**: PCB四层板设计+合理布局